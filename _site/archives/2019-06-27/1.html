<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1" /> <title>基于BurpSuite快速探测越权-Authz插件 · Chen's Blog</title> <meta name="description" content="BurpSuite - Authz"> <link rel="icon" href="http://localhost:4000/assets/favicon.png"> <link rel="apple-touch-icon" href="http://localhost:4000/assets/touch-icon.png"> <link rel="stylesheet" href="http://localhost:4000/assets/core.css"> <link rel="canonical" href="http://localhost:4000/archives/2019-06-27/1"> <link rel="alternate" type="application/atom+xml" title="Chen's Blog" href="http://localhost:4000/feed.xml" /> <link href="/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" media="all" /> <script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?e4a42a371cc5994ee02b940034c29658"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script> </head> <body> <aside class="logo"> <a href="http://localhost:4000/"> <img src="/assets/avatar.jpg" class="logo-avatar"> </a> <span class="logo-prompt code">Back to Index</span> </aside> <article> <h1 class="title">ᴀᴜᴛʜᴏʀ: ᴠᴜʟᴋᴇʏ_ᴄʜᴇɴ</h1> <div class="divider"></div> <center><a href="/about" target="_blank">ᴀʙᴏᴜᴛ</a> | <a href="/links" target="_blank">ʟɪɴᴋs</a> | <a href="/AssistTool" target="_blank">ᴀssɪsᴛ ᴛᴏᴏʟ</a> | <a href="/RGPerson" target="_blank">ʀɢᴘᴇʀsᴏɴ</a> | <a href="/Binary-Learning" target="_blank">ʙɪɴᴀʀʏ ʟᴇᴀʀɴɪɴɢ</a></center> <div class="divider"></div> </article> <div id="content"> <article> <div class="center"> <h1 class="title">基于BurpSuite快速探测越权-Authz插件</h1> <time class="code">June 27, 2019</time> </div> <div class="divider"></div> <h1 id="burpsuite---authz">BurpSuite - Authz</h1> <h2 id="背景">背景</h2> <p>在平时的测试中，会经常的碰到业务功能较多的站点，如果想全面又快速的完成逻辑越权漏洞的检测不得不借助Authz插件去辅助检测越权问题。</p> <h2 id="authz的工作原理">Authz的工作原理</h2> <p>我们平时做测试的时候发现越权问题都是基于修改ID的方式：<strong>A的ID改成B的ID然后进行请求查看是否可以越权获取到信息</strong>，<strong>或当ID的规律已知情况下基于Burp Intruder模块直接去遍历ID</strong>。<strong>而基于Authz的检测是不一样的，其是将用户认证的HTTP请求头进行修改（Cookie之类的），然后通过响应长度、响应状态码判断是否存在越权</strong>；<strong>从本质上来讲没有任何区别，只是换了一个角度</strong>，但这样的<strong>好处</strong>是一定程度上的减少了测试的时间（例如：<strong>一个商城的业务系统，你有A、B账户，A账户买了个商品获得一个订单信息请求，当你想测试是否能越权获取B账户订单时就需要使用B账户去再购买，然后判断测试。</strong>）</p> <p><img src="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2019-06-27/15596409209407.jpg" alt="" /></p> <p>BurpSuite Authz插件界面</p> <h2 id="安装authz插件">安装Authz插件</h2> <p>Github地址：<a href="https://github.com/portswigger/authz">https://github.com/portswigger/authz</a></p> <p><strong>快速安装-&gt;在BurpSuite的BApp Store应用市场可以直接下载安装：</strong></p> <p><img src="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2019-06-27/15596409359506.jpg" alt="" /></p> <h2 id="使用authz插件检测">使用Authz插件检测</h2> <p>使用插件检测的前提条件：<strong>同个业务系统中两个测试账号</strong></p> <p>作用：A账户用于功能的操作，B账户用于提供凭证（Cookie或者其他的用户身份凭证请求头）</p> <p><strong>举例说明：</strong></p> <p>一个业务系统，将A、B账户登入，同时获取B账户的Cookie或者其他的用户身份凭证请求头，填入到Authz的New Header里：</p> <p><img src="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2019-06-27/15596409465945.jpg" alt="" /></p> <p>A账户去请求（Burp别忘了监听着），寻找读取类请求（该类请求要包含ID之类的特征）然后右键请求包将该请求发送到Authz插件内：</p> <p><img src="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2019-06-27/15596409564945.jpg" alt="" /></p> <p>发送的请求会在Burp的Authz的Tab标签窗口内：</p> <p><img src="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2019-06-27/15596409674592.jpg" alt="" /></p> <p>当收集的差不多了，点击run跑起来：</p> <p><img src="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2019-06-27/15596409749591.jpg" alt="" /></p> <p>结果会在Responses处显示：</p> <p><img src="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2019-06-27/15596409846702.jpg" alt="" /></p> <p>当原响应内容长度、响应状态码和被修改后请求的响应内容长度、响应状态码一致则会绿。</p> <p>也就代表着存在越权，单击选择一行即可在下面展示出请求、响应的报文：</p> <p><img src="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2019-06-27/15596409926174.jpg" alt="" /></p> <p>这里经过进一步检验（<strong>理论上不需要检验，但出于对测试的严谨态度还是检验一下比较好～</strong>）顺利的发现了三枚越权访问漏洞。</p> <p>一个业务系统测完之后就Clear掉所有的东西，接着下一个业务系统咯：</p> <p><img src="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2019-06-27/15596410022495.jpg" alt="" /></p> <h2 id="authz的优点和缺点总结">Authz的优点和缺点总结</h2> <p>优点：使用简单、省时省力</p> <p>缺点：只是适用于检测越权读取类操作，删除编辑类操作还需人工判断。</p> </article> <div class="page-navigation code"> <a class="next" href="http://localhost:4000/archives/2019-08-16/1" title="NEXT: RGPerson - 随机身份生成脚本">&lt;&lt;</a> <span> &middot; </span> <a class="home" href="http://localhost:4000/" title="Back to Index">INDEX</a> <span> &middot; </span> <a class="prev" href="http://localhost:4000/archives/2019-03-20/1" title="PREV: 浅谈WebSocket跨域劫持漏洞(CSWSH)">&gt;&gt;</a> </div> </div> <div class="footer"> <span class="block">&lt;/&gt; Copyright &copy; Chen's Blog (GH0ST.CN) 2016-2021</span> </div> <script src="/fancybox/lib/jquery-1.10.2.min.js"></script> <script type="text/javascript" src="/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script> <script> $(document).ready(function() { $("article img").each(function() { var strA = "<a style='text-decoration: none;' id='imgid' href='" + this.src + "'></a>"; $(this).wrapAll(strA); }); $(".block").html("&lt;/&gt; Copyright &copy; Chen's Blog (GH0ST.CN) 2016-" + (new Date()).getFullYear()); }); $("#imgid").fancybox({ openEffect : 'elastic', closeEffect : 'elastic', }); </script> </body> </html>
